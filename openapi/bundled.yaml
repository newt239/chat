openapi: 3.1.0
info:
  title: Chat API
  version: 0.1.0
  description: Slack-like communication application API
servers:
  - url: http://localhost:8080
    description: Local development server
paths:
  /api/attachments/presign:
    post:
      operationId: presignUpload
      summary: Get presigned upload URL
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PresignRequest'
      responses:
        '200':
          description: Presigned URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresignResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/attachments/{id}:
    get:
      operationId: getAttachment
      summary: Get attachment metadata
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Attachment metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Attachment'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Attachment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/attachments/{id}/download:
    get:
      operationId: downloadAttachment
      summary: Get presigned download URL
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Presigned download URL
          content:
            application/json:
              schema:
                type: object
                properties:
                  downloadUrl:
                    type: string
                    format: uri
                required:
                  - downloadUrl
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Attachment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/auth/login:
    post:
      operationId: login
      summary: Login user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/auth/logout:
    post:
      operationId: logout
      summary: Logout user
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logout successful
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/auth/refresh:
    post:
      operationId: refresh
      summary: Refresh access token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshRequest'
      responses:
        '200':
          description: Token refreshed
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                required:
                  - accessToken
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/auth/register:
    post:
      operationId: register
      summary: Register a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: User created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/bookmarks:
    get:
      operationId: listBookmarks
      summary: List user bookmarks
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of bookmarks
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListBookmarksResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/members:
    get:
      operationId: listChannelMembers
      summary: List channel members
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of channel members
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListChannelMembersResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: inviteChannelMember
      summary: Invite member to channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InviteChannelMemberRequest'
      responses:
        '200':
          description: Member invited
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel or user not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Already a member
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/members/self:
    post:
      operationId: joinPublicChannel
      summary: Join public channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Joined channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Channel is private
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: leaveChannel
      summary: Leave channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Left channel
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Cannot leave - last admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/members/{userId}:
    delete:
      operationId: removeChannelMember
      summary: Remove member from channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Member removed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel or member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Cannot remove - last admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/members/{userId}/role:
    patch:
      operationId: updateChannelMemberRole
      summary: Update channel member role
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateChannelMemberRoleRequest'
      responses:
        '200':
          description: Member role updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel or member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Cannot update - last admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/messages:
    get:
      operationId: listMessages
      summary: List messages in channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            minimum: 1
            maximum: 100
        - name: since
          in: query
          schema:
            type: string
            format: date-time
        - name: until
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: List of messages
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessagesResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createMessage
      summary: Create a new message
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMessageRequest'
      responses:
        '201':
          description: Message created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/messages/with-threads:
    get:
      operationId: listMessagesWithThread
      summary: List messages in channel with thread metadata
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            minimum: 1
            maximum: 100
        - name: since
          in: query
          schema:
            type: string
            format: date-time
        - name: until
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: List of messages with thread metadata
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/Message'
                        - type: object
                          properties:
                            threadMetadata:
                              $ref: '#/components/schemas/ThreadMetadata'
                              nullable: true
                  hasMore:
                    type: boolean
                required:
                  - messages
                  - hasMore
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Channel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/pins:
    get:
      operationId: listPins
      summary: List pinned messages in a channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
        - name: cursor
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Pinned messages
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListPinsResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createPin
      summary: Pin a message in a channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                messageId:
                  type: string
                  format: uuid
              required:
                - messageId
      responses:
        '200':
          description: Pinned
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/pins/{messageId}:
    delete:
      operationId: deletePin
      summary: Unpin a message in a channel
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Unpinned
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/reads:
    post:
      operationId: updateReadState
      summary: Update channel read state
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateReadStateRequest'
      responses:
        '200':
          description: Read state updated
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/channels/{channelId}/unread_count:
    get:
      operationId: getUnreadCount
      summary: Get unread message count
      security:
        - bearerAuth: []
      parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Unread count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnreadCountResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/links/fetch-ogp:
    post:
      operationId: fetchOGP
      summary: Fetch OGP data for a URL
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FetchOGPRequest'
      responses:
        '200':
          description: OGP data retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FetchOGPResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/messages/{messageId}:
    patch:
      operationId: updateMessage
      summary: Update a message
      description: Updates a message body (author or admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMessageRequest'
      responses:
        '200':
          description: Message updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '400':
          description: Bad request or message already deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - not message author or admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: deleteMessage
      summary: Delete a message
      description: Deletes a message (author or admin only)
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Message deleted successfully
        '400':
          description: Bad request or message already deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - not message author or admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/messages/{messageId}/bookmarks:
    post:
      operationId: addBookmark
      summary: Add bookmark to message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '201':
          description: Bookmark added
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: removeBookmark
      summary: Remove bookmark from message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Bookmark removed
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/messages/{messageId}/reactions:
    get:
      operationId: listReactions
      summary: List reactions for a message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of reactions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListReactionsResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: addReaction
      summary: Add a reaction to a message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddReactionRequest'
      responses:
        '201':
          description: Reaction added
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/messages/{messageId}/reactions/{emoji}:
    delete:
      operationId: removeReaction
      summary: Remove a reaction from a message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: emoji
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Reaction removed
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Reaction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/messages/{messageId}/thread:
    get:
      operationId: getThreadReplies
      summary: Get thread replies for a message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: Thread replies retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreadRepliesResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/messages/{messageId}/thread/metadata:
    get:
      operationId: getThreadMetadata
      summary: Get thread metadata for a message
      security:
        - bearerAuth: []
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Thread metadata retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreadMetadata'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message or metadata not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/threads/{threadId}/read:
    post:
      operationId: markThreadRead
      summary: Mark thread as read
      security:
        - bearerAuth: []
      parameters:
        - name: threadId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Thread marked as read
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-groups:
    post:
      operationId: createUserGroup
      summary: Create a new user group
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserGroupRequest'
      responses:
        '201':
          description: User group created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserGroup'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    get:
      operationId: listUserGroups
      summary: List user groups
      security:
        - bearerAuth: []
      parameters:
        - name: workspace_id
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User groups retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  userGroups:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserGroup'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-groups/{id}:
    get:
      operationId: getUserGroup
      summary: Get a user group
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: User group retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserGroup'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    patch:
      operationId: updateUserGroup
      summary: Update a user group
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserGroupRequest'
      responses:
        '200':
          description: User group updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserGroup'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: deleteUserGroup
      summary: Delete a user group
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: User group deleted
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/user-groups/{id}/members:
    post:
      operationId: addUserGroupMember
      summary: Add a member to a user group
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMemberRequest'
      responses:
        '201':
          description: Member added
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    get:
      operationId: listUserGroupMembers
      summary: List members of a user group
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Members retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  members:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserGroupMember'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: removeUserGroupMember
      summary: Remove a member from a user group
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: user_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Member removed
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User group or member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces:
    get:
      operationId: listWorkspaces
      summary: List user workspaces
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of workspaces
          content:
            application/json:
              schema:
                type: object
                properties:
                  workspaces:
                    type: array
                    items:
                      $ref: '#/components/schemas/Workspace'
                required:
                  - workspaces
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createWorkspace
      summary: Create a new workspace
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWorkspaceRequest'
      responses:
        '201':
          description: Workspace created
          content:
            application/json:
              schema: null
              type: object
              properties:
                id:
                  type: string
                  description: slug identifier (3-12 chars, lowercase, digits, hyphen)
                name:
                  type: string
                description:
                  type: string
                  nullable: true
                iconUrl:
                  type: string
                  nullable: true
                isPublic:
                  type: boolean
                role:
                  type: string
                  enum:
                    - owner
                    - admin
                    - member
                    - guest
                createdBy:
                  type: string
                  format: uuid
                createdAt:
                  type: string
                  format: date-time
              required:
                - name
                - createdBy
                - createdAt
  /api/workspaces/public:
    get:
      operationId: listPublicWorkspaces
      summary: List all public workspaces
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Public workspaces
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListPublicWorkspacesResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{id}/channels:
    get:
      operationId: listChannels
      summary: List channels in workspace
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: List of channels
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Channel'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createChannel
      summary: Create a new channel
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateChannelRequest'
      responses:
        '201':
          description: Channel created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{id}/dms:
    get:
      operationId: listDMs
      summary: List DMs in workspace
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of DMs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DMOutput'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: createDM
      summary: Create a 1:1 DM
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDMRequest'
      responses:
        '200':
          description: DM created or retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DMOutput'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{id}/group-dms:
    post:
      operationId: createGroupDM
      summary: Create a group DM
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGroupDMRequest'
      responses:
        '200':
          description: Group DM created or retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DMOutput'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{id}/join:
    post:
      operationId: joinPublicWorkspace
      summary: Join a public workspace
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Joined
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                required:
                  - message
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{id}/members:
    get:
      operationId: listMembers
      summary: List workspace members
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: List of members
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListMembersResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      operationId: addMemberByEmail
      summary: Add member to workspace by email
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMemberRequest'
      responses:
        '201':
          description: Member added
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                required:
                  - message
  /api/workspaces/{id}/members/{userId}:
    patch:
      operationId: updateMemberRole
      summary: Update member role
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMemberRoleRequest'
      responses:
        '200':
          description: Member role updated
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      operationId: removeMember
      summary: Remove member from workspace
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Member removed
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{workspaceId}/search:
    get:
      operationId: searchWorkspace
      summary: Search workspace content
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
        - name: q
          in: query
          required: true
          schema:
            type: string
        - name: filter
          in: query
          schema:
            type: string
            enum:
              - all
              - messages
              - channels
              - users
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
        - name: perPage
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
      responses:
        '200':
          description: Search results returned successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkspaceSearchResponse'
        '400':
          description: Invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/workspaces/{workspaceId}/threads/participating:
    get:
      operationId: getParticipatingThreads
      summary: Get participating threads
      security:
        - bearerAuth: []
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            type: string
        - name: cursorLastActivityAt
          in: query
          required: false
          schema:
            type: string
            format: date-time
        - name: cursorThreadId
          in: query
          required: false
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: List of participating threads
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ParticipatingThreadsOutput'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /healthz:
    get:
      operationId: healthz
      summary: Health check
      responses:
        '200':
          description: OK
          content:
            text/plain:
              schema:
                type: string
                example: ok
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    AddMemberRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        role:
          type: string
          enum:
            - admin
            - member
          default: member
      required:
        - email
    AddReactionRequest:
      type: object
      properties:
        emoji:
          type: string
          minLength: 1
      required:
        - emoji
    Attachment:
      type: object
      properties:
        id:
          type: string
          format: uuid
        messageId:
          type: string
          format: uuid
        fileName:
          type: string
        mimeType:
          type: string
        sizeBytes:
          type: integer
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - messageId
        - fileName
        - mimeType
        - sizeBytes
        - createdAt
    AuthResponse:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
        user:
          $ref: '#/components/schemas/User'
      required:
        - accessToken
        - refreshToken
        - user
    BookmarkWithMessage:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        message:
          $ref: '#/components/schemas/Message'
        createdAt:
          type: string
          format: date-time
      required:
        - userId
        - message
        - createdAt
    Channel:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
        name:
          type: string
        description:
          type: string
          nullable: true
        isPrivate:
          type: boolean
        channelType:
          type: string
          enum:
            - public
            - private
            - dm
            - group_dm
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        unreadCount:
          type: integer
          description: 
          minimum: 0
        hasMention:
          type: boolean
          description: 
      required:
        - id
        - workspaceId
        - name
        - isPrivate
        - createdBy
        - createdAt
    ChannelMemberInfo:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        email:
          type: string
          format: email
        displayName:
          type: string
        avatarUrl:
          type: string
          nullable: true
        role:
          type: string
          enum:
            - member
            - admin
        joinedAt:
          type: string
          format: date-time
      required:
        - userId
        - email
        - displayName
        - role
        - joinedAt
    CreateChannelRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        description:
          type: string
        isPrivate:
          type: boolean
          default: false
      required:
        - name
    CreateDMRequest:
      type: object
      properties:
        userId:
          type: string
          format: uuid
      required:
        - userId
    CreateGroupDMRequest:
      type: object
      properties:
        userIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 2
          maxItems: 9
        name:
          type: string
      required:
        - userIds
    CreateMessageRequest:
      type: object
      properties:
        body:
          type: string
          minLength: 1
        parentId:
          type: string
          format: uuid
        attachmentIds:
          type: array
          items:
            type: string
            format: uuid
      required:
        - body
    CreateUserGroupRequest:
      type: object
      properties:
        workspaceId:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        description:
          type: string
      required:
        - workspaceId
        - name
    CreateWorkspaceRequest:
      type: object
      properties:
        id:
          type: string
          minLength: 3
          maxLength: 12
          pattern: ^[a-z0-9][a-z0-9-]*[a-z0-9]$
        name:
          type: string
          minLength: 1
        description:
          type: string
        iconUrl:
          type: string
          format: uri
        isPublic:
          type: boolean
      required:
        - id
        - name
    DMMember:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        displayName:
          type: string
        avatarUrl:
          type: string
          nullable: true
      required:
        - userId
        - displayName
    DMOutput:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        type:
          type: string
          enum:
            - dm
            - group_dm
        members:
          type: array
          items:
            $ref: '#/components/schemas/DMMember'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - workspaceId
        - name
        - type
        - members
        - createdAt
        - updatedAt
    Error:
      type: object
      properties:
        error:
          type: string
      required:
        - error
    FetchOGPRequest:
      type: object
      properties:
        url:
          type: string
          format: uri
      required:
        - url
    FetchOGPResponse:
      type: object
      properties:
        ogpData:
          type: object
          properties:
            title:
              type: string
              nullable: true
            description:
              type: string
              nullable: true
            imageUrl:
              type: string
              nullable: true
            siteName:
              type: string
              nullable: true
            cardType:
              type: string
              nullable: true
      required:
        - ogpData
    InviteChannelMemberRequest:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        role:
          type: string
          enum:
            - member
            - admin
          default: member
      required:
        - userId
    ListBookmarksResponse:
      type: object
      properties:
        bookmarks:
          type: array
          items:
            $ref: '#/components/schemas/BookmarkWithMessage'
      required:
        - bookmarks
    ListChannelMembersResponse:
      type: object
      properties:
        members:
          type: array
          items:
            $ref: '#/components/schemas/ChannelMemberInfo'
      required:
        - members
    ListMembersResponse:
      type: object
      properties:
        members:
          type: array
          items:
            $ref: '#/components/schemas/MemberInfo'
      required:
        - members
    ListPinsResponse:
      type: object
      properties:
        pins:
          type: array
          items:
            $ref: '#/components/schemas/PinnedMessage'
        nextCursor:
          type: string
          nullable: true
      required:
        - pins
    ListPublicWorkspacesResponse:
      type: object
      properties:
        workspaces:
          type: array
          items:
            $ref: '#/components/schemas/PublicWorkspaceItem'
      required:
        - workspaces
    ListReactionsResponse:
      type: object
      properties:
        reactions:
          type: array
          items:
            $ref: '#/components/schemas/ReactionWithUser'
      required:
        - reactions
    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
      required:
        - email
        - password
    MemberInfo:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        email:
          type: string
          format: email
        displayName:
          type: string
        avatarUrl:
          type: string
          nullable: true
        role:
          type: string
          enum:
            - owner
            - admin
            - member
        joinedAt:
          type: string
          format: date-time
      required:
        - userId
        - email
        - displayName
        - role
        - joinedAt
    Message:
      type: object
      properties:
        id:
          type: string
          format: uuid
        channelId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        parentId:
          type: string
          format: uuid
          nullable: true
        body:
          type: string
        createdAt:
          type: string
          format: date-time
        editedAt:
          type: string
          format: date-time
          nullable: true
        deletedAt:
          type: string
          format: date-time
          nullable: true
        isDeleted:
          type: boolean
        deletedBy:
          type: object
          nullable: true
          properties:
            id:
              type: string
              format: uuid
            displayName:
              type: string
            avatarUrl:
              type: string
              nullable: true
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/Attachment'
      required:
        - id
        - channelId
        - userId
        - body
        - createdAt
        - isDeleted
    MessageBookmark:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        messageId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
      required:
        - userId
        - messageId
        - createdAt
    MessageReaction:
      type: object
      properties:
        messageId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        emoji:
          type: string
          description: UnicodeID
        createdAt:
          type: string
          format: date-time
      required:
        - messageId
        - userId
        - emoji
        - createdAt
    MessagesResponse:
      type: object
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        hasMore:
          type: boolean
      required:
        - messages
        - hasMore
    PaginatedChannels:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Channel'
        total:
          type: integer
          minimum: 0
        page:
          type: integer
          minimum: 1
        perPage:
          type: integer
          minimum: 1
        hasMore:
          type: boolean
      required:
        - items
        - total
        - page
        - perPage
        - hasMore
    PaginatedMessages:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        total:
          type: integer
          minimum: 0
        page:
          type: integer
          minimum: 1
        perPage:
          type: integer
          minimum: 1
        hasMore:
          type: boolean
      required:
        - items
        - total
        - page
        - perPage
        - hasMore
    PaginatedUsers:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/MemberInfo'
        total:
          type: integer
          minimum: 0
        page:
          type: integer
          minimum: 1
        perPage:
          type: integer
          minimum: 1
        hasMore:
          type: boolean
      required:
        - items
        - total
        - page
        - perPage
        - hasMore
    ParticipatingThread:
      type: object
      properties:
        thread_id:
          type: string
          format: uuid
        channel_id:
          type: string
          format: uuid
          nullable: true
        first_message:
          $ref: '#/components/schemas/Message'
        reply_count:
          type: integer
          minimum: 0
        last_activity_at:
          type: string
          format: date-time
        unread_count:
          type: integer
          minimum: 0
      required:
        - thread_id
        - first_message
        - reply_count
        - last_activity_at
        - unread_count
    ParticipatingThreadsOutput:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ParticipatingThread'
        next_cursor:
          $ref: '#/components/schemas/ThreadCursor'
          nullable: true
      required:
        - items
    PinnedMessage:
      type: object
      properties:
        message:
          $ref: '#/components/schemas/Message'
        pinnedAt:
          type: string
          format: date-time
        pinnedBy:
          type: string
          format: uuid
      required:
        - message
        - pinnedAt
        - pinnedBy
    PresignRequest:
      type: object
      properties:
        fileName:
          type: string
        contentType:
          type: string
        sizeBytes:
          type: integer
        channelId:
          type: string
          format: uuid
      required:
        - fileName
        - contentType
        - sizeBytes
        - channelId
    PresignResponse:
      type: object
      properties:
        uploadUrl:
          type: string
          format: uri
        attachmentId:
          type: string
          format: uuid
      required:
        - uploadUrl
        - attachmentId
    PublicWorkspaceItem:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
          nullable: true
        iconUrl:
          type: string
          nullable: true
        memberCount:
          type: integer
          minimum: 0
        isJoined:
          type: boolean
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - memberCount
        - isJoined
        - createdAt
    ReactionWithUser:
      type: object
      properties:
        messageId:
          type: string
          format: uuid
        user:
          type: object
          properties:
            id:
              type: string
              format: uuid
            displayName:
              type: string
            avatarUrl:
              type: string
              nullable: true
          required:
            - id
            - displayName
        emoji:
          type: string
        createdAt:
          type: string
          format: date-time
      required:
        - messageId
        - user
        - emoji
        - createdAt
    RefreshRequest:
      type: object
      properties:
        refreshToken:
          type: string
      required:
        - refreshToken
    RegisterRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
        displayName:
          type: string
          minLength: 1
      required:
        - email
        - password
        - displayName
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
      required:
        - success
    ThreadCursor:
      type: object
      properties:
        last_activity_at:
          type: string
          format: date-time
        thread_id:
          type: string
          format: uuid
      required:
        - last_activity_at
        - thread_id
    ThreadMetadata:
      type: object
      properties:
        messageId:
          type: string
          format: uuid
        replyCount:
          type: integer
          minimum: 0
        lastReplyAt:
          type: string
          format: date-time
          nullable: true
        lastReplyUser:
          type: object
          nullable: true
          properties:
            id:
              type: string
              format: uuid
            displayName:
              type: string
            avatarUrl:
              type: string
              nullable: true
          required:
            - id
            - displayName
        participantUserIds:
          type: array
          items:
            type: string
            format: uuid
      required:
        - messageId
        - replyCount
        - participantUserIds
    ThreadRepliesResponse:
      type: object
      properties:
        parentMessage:
          $ref: '#/components/schemas/Message'
        replies:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        hasMore:
          type: boolean
      required:
        - parentMessage
        - replies
        - hasMore
    UnreadCountResponse:
      type: object
      properties:
        count:
          type: integer
          minimum: 0
      required:
        - count
    UpdateChannelMemberRoleRequest:
      type: object
      properties:
        role:
          type: string
          enum:
            - member
            - admin
      required:
        - role
    UpdateMemberRoleRequest:
      type: object
      properties:
        role:
          type: string
          enum:
            - admin
            - member
      required:
        - role
    UpdateMessageRequest:
      type: object
      properties:
        body:
          type: string
          minLength: 1
          maxLength: 10000
      required:
        - body
    UpdateReadStateRequest:
      type: object
      properties:
        lastReadAt:
          type: string
          format: date-time
      required:
        - lastReadAt
    UpdateUserGroupRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        description:
          type: string
      required:
        - name
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        displayName:
          type: string
        avatarUrl:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - email
        - displayName
        - createdAt
    UserGroup:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - workspaceId
        - name
        - createdBy
        - createdAt
        - updatedAt
    UserGroupMember:
      type: object
      properties:
        groupId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        joinedAt:
          type: string
          format: date-time
      required:
        - groupId
        - userId
        - joinedAt
    Workspace:
      type: object
      properties:
        id:
          type: string
          description: slug identifier (3-12 chars, lowercase, digits, hyphen)
        name:
          type: string
        description:
          type: string
          nullable: true
        iconUrl:
          type: string
          nullable: true
        isPublic:
          type: boolean
        role:
          type: string
          enum:
            - owner
            - admin
            - member
            - guest
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
      required:
        - name
        - createdBy
        - createdAt
    WorkspaceSearchResponse:
      type: object
      properties:
        messages:
          $ref: '#/components/schemas/PaginatedMessages'
        channels:
          $ref: '#/components/schemas/PaginatedChannels'
        users:
          $ref: '#/components/schemas/PaginatedUsers'
      required:
        - messages
        - channels
        - users
