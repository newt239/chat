# Coding Agent Guidelines

## 基本原則

- 常に日本語でコミュニケーションを行ってください。すべてのコミットメッセージ、コメント、エラーメッセージ、ユーザーとのやり取りは日本語で行ってください。
- ファイルの削除を行う場合は、必ず実行前に以下を報告し、明示的なユーザー承認を得てください。
  - 対象ファイルのリスト
  - 実行する変更の詳細説明
  - 影響範囲の説明
- 不明な点がある場合は常に質問し、推測で進めてはなりません。
- 常に DRY なコードを心がけてください。

## デバッグ

- フロントエンド、バックエンドいずれも Docker 上で実行しています。デバッグを行う場合は、Docker コンテナ内で行ってください。
- 起動は `docker-compose up -d --build` で行ってください。ただし、すでにユーザーが起動している場合もあるので、すでに起動されている場合はスキップしてください。
- 依存関係に変更が生まれた場合は `docker-compose down -v` でコンテナを停止・削除し、`docker-compose up -d --build` で再起動してください。
- ローカルで動作させるための実装は不要です。
- テスト用アカウントとしてユーザー名`alice@example.com`、パスワード`password123`を使用できます。

## リファクタリング

- コードのリファクタリングを指示された場合は、テストを除く総コード行数がなるべく少なくなるよう意識してください。

## フロントエンド

- フロントエンドの実装をした際は、必ず最後に`npx tsc --noEmit && pnpm run lint:fix`を実行してください。
  - 修正にあたり、any/unknown などの型を使用することや、型アサーション・型ガードを使用することを禁止します。その実装にふさわしい型を書くか、ライブラリから提供されているものをインポートして使用してください。どうしても型アサーションを使用する必要がある場合は最後にまとめて確認を取ってください。
- 新しいコンポーネントを実装した際は必ず Vitest でテストを書いてください。
  - ユニットテストは対象のファイルと同階層に`filename.test.{ts,tsx}`という名前で実装してください。
- 型定義に`interface`を使用せず、必ず`type`を使用してください。
- 安易に`window`オブジェクトを使用しないでください。
  - 例えばページ遷移であれば Tanstack Router の Link コンポーネントや useNavigate を使用してください。
- 使用しない引数は削除してください。また、極力引数は Optional にしないようにしてください。
- インポート文は原則として絶対パスで書いてください。ただし、同階層や一つ上の階層に限って相対パスでの記述を許可します。
- 1 つのファイルにつき 1 つのコンポーネントを定義してください。コンポーネント名とファイル名は一致させ、Named Export でコンポーネントをエクスポートしてください。
- 関数の返り値の型は明示しないでください。
- バックエンドのレスポンススキーマを変更した場合はフロントエンドのスクリプトにある`pnpm run generate:api`を実行して API クライアントのスキーマを更新してください。

## バックエンド

- エントリーポイントは`backend/cmd/server/main.go`です。
- 常にクリーンアーキテクチャを意識してください。
- 冗長なコードは避けてください。
